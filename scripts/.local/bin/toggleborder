#!/bin/sh

nobar() {
	bspc config border_width 1
	bspc config window_gap 0
	bspc config top_padding 0
	bspc config bottom_padding 0
	bspc config left_padding 0
	bspc config right_padding 0
	polybar-msg cmd hide
}

bar() {
	bspc config border_width 1
	bspc config window_gap 0
	bspc config top_padding 24
	bspc config bottom_padding 0
	bspc config left_padding 0
	bspc config right_padding 0
	polybar-msg cmd show
}

normal() {
	bspc config border_width 2
	bspc config window_gap 3
	bspc config top_padding 32
	bspc config bottom_padding 5
	bspc config left_padding 5
	bspc config right_padding 5
	polybar-msg cmd show
}

while getopts ":nl:" arg; do
	case $arg in
		n)
			reset=true
			;;
		l)
			layout="$OPTARG"
			;;
		*)
			layout="$OPTARG"
			;;
	esac
done

[ -n "$reset" ] && normal && exit 0
case "$layout" in
	withbar)
		if [ -f /tmp/bspgap ]; then
			rm /tmp/bspgap
			normal
		else
			if [ -f /tmp/bspgapnobar ]; then
				rm /tmp/bspgapnobar
				normal
			else
				touch /tmp/bspgap
				bar
			fi
		fi
		;;
	nobar)
		rm /tmp/bspgap
		if [ -f /tmp/bspgapnobar ]; then
			rm /tmp/bspgapnobar
			normal
		else
			touch /tmp/bspgapnobar
			nobar
		fi
		;;
	*)
		rm /tmp/bspgap
		rm /tmp/bspgapnobar
		normal
esac
